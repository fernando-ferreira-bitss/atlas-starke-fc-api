# Mapeamento de Dados: Mega API → Starke
# Configuração de classes financeiras e contas contábeis

# ============================================
# CLASSES FINANCEIRAS - CASH OUT (Despesas)
# ============================================
# Mapeia códigos de classe financeira do Mega para categorias do Starke
# IMPORTANTE: Estes códigos devem ser ajustados conforme o plano de contas
# da sua instalação do Mega

cash_out_categories:
  # OPEX - Despesas Operacionais
  opex:
    - "1.2.01"  # Salários e Encargos
    - "1.2.02"  # Manutenção e Conservação
    - "1.2.03"  # Utilities (água, luz, gás)
    - "1.2.04"  # Marketing e Publicidade
    - "1.2.05"  # Administração Geral
    - "1.2.06"  # Seguros
    - "1.2.07"  # Taxas e Impostos Operacionais
    - "1.2.08"  # Serviços de Terceiros
    - "1.2.09"  # Material de Consumo
    - "1.2.10"  # Despesas com Vendas

  # CAPEX - Investimentos de Capital
  capex:
    - "1.1.01"  # Construção Civil
    - "1.1.02"  # Equipamentos e Instalações
    - "1.1.03"  # Melhorias e Benfeitorias
    - "1.1.04"  # Terrenos
    - "1.1.05"  # Projetos e Estudos
    - "1.1.06"  # Tecnologia e Sistemas

  # Despesas Financeiras
  financeiras:
    - "1.3.01"  # Juros de Empréstimos
    - "1.3.02"  # Taxas Bancárias
    - "1.3.03"  # IOF
    - "1.3.04"  # Descontos Concedidos
    - "1.3.05"  # Despesas com Cartão de Crédito
    - "1.3.06"  # Variação Cambial Passiva

  # Distribuições aos Sócios
  distribuicoes:
    - "1.4.01"  # Dividendos
    - "1.4.02"  # Lucros Distribuídos
    - "1.4.03"  # JCP - Juros sobre Capital Próprio
    - "1.4.04"  # Distribuição de Resultado

# ============================================
# TIPO DOCUMENTO - CASH OUT (Despesas)
# ============================================
# Mapeia TipoDocumento do Mega para categorias do Starke
# Usado quando a classe financeira não está disponível

tipo_documento_categories:
  # OPEX - Despesas Operacionais
  opex:
    - "NOTA FISCAL"
    - "RECIBO"
    - "FATURA"
    - "BOLETO"
    - "SERVICO"
    - "FOLHA DE PAGAMENTO"
    - "DESPESA"
    - "HONORARIOS"

  # CAPEX - Investimentos de Capital
  capex:
    - "NOTA FISCAL CONSTRUCAO"
    - "MEDICAO"
    - "FATURA CONSTRUCAO"
    - "EQUIPAMENTO"
    - "INSTALACAO"

  # Despesas Financeiras
  financeiras:
    - "JUROS"
    - "IOF"
    - "TAXA BANCARIA"
    - "EMPRESTIMO"
    - "FINANCIAMENTO"

  # Distribuições aos Sócios
  distribuicoes:
    - "DISTRATO"
    - "DIVIDENDO"
    - "LUCRO"
    - "JCP"
    - "DISTRIBUICAO"
    - "PRO-LABORE"
    - "RETIRADA"

# ============================================
# CLASSES FINANCEIRAS - CASH IN (Receitas)
# ============================================

cash_in_categories:
  # Outras Receitas (não relacionadas a contratos de venda)
  outras:
    - "2.1.05"  # Receitas Financeiras
    - "2.1.06"  # Aluguéis Recebidos
    - "2.1.07"  # Multas e Juros Recebidos
    - "2.1.08"  # Receitas Eventuais
    - "2.1.09"  # Variação Cambial Ativa
    - "2.1.10"  # Outras Receitas Operacionais

# ============================================
# CONTAS CONTÁBEIS - DISPONIBILIDADES
# ============================================
# Contas que representam Caixa e Bancos para cálculo de Balance

contas_disponibilidades:
  # Caixa
  - "1.1.1.01.001"
  - "1.1.1.01.002"  # Caixa - Matriz
  - "1.1.1.01.003"  # Caixa - Filial 1

  # Bancos - Conta Corrente
  - "1.1.1.02.001"  # Banco do Brasil - CC
  - "1.1.1.02.002"  # Bradesco - CC
  - "1.1.1.02.003"  # Itaú - CC
  - "1.1.1.02.004"  # Santander - CC
  - "1.1.1.02.005"  # Caixa Econômica - CC

  # Aplicações Financeiras de Curto Prazo (disponibilidade imediata)
  - "1.1.1.03.001"  # CDB - Banco do Brasil
  - "1.1.1.03.002"  # CDB - Bradesco
  - "1.1.1.03.003"  # Fundo DI

# ============================================
# MAPEAMENTO EMPREENDIMENTO → FILIAL/CENTRO DE CUSTO
# ============================================
# Usado apenas se o relacionamento não puder ser obtido diretamente da API
# Normalmente o endpoint /api/globalestruturas/Empreendimentos já retorna
# filial e centro de custo

# empreendimento_mapping:
#   1001:  # ID do empreendimento
#     filial: 4
#     centro_custo: 1001
#     projeto: 5001
#   1002:
#     filial: 4
#     centro_custo: 1002
#     projeto: 5002

# ============================================
# CONFIGURAÇÕES FINANCEIRAS
# ============================================

financeiro:
  # Taxa de desconto padrão para cálculo de Duration (% ao ano)
  taxa_desconto_padrao: 0.10  # 10% a.a.

  # Taxa de desconto específica por empreendimento (sobrescreve a padrão)
  # Descomente e configure se necessário
  # taxa_desconto_por_empreendimento:
  #   1001: 0.10
  #   1002: 0.12
  #   1003: 0.09

  # Prazo mínimo de vencimento para considerar no cálculo de VP (em dias)
  # Parcelas vencidas há mais tempo que isso podem ser excluídas do VP
  prazo_minimo_vp_dias: -365  # Até 1 ano vencido

# ============================================
# CONFIGURAÇÕES DE INTEGRAÇÃO
# ============================================

integracao:
  # Período padrão para sincronização inicial (em meses)
  periodo_inicial_meses: 12

  # Quantidade de dias para trás ao buscar dados (sincronização incremental)
  janela_sincronizacao_dias: 7

  # Timeout para chamadas à API (em segundos)
  timeout_api_segundos: 60

  # Tentativas de retry em caso de erro
  max_retries: 3

  # Delay entre retries (em segundos)
  retry_delay_segundos: 5

  # Batch size para processamento de registros
  batch_size: 100

# ============================================
# FILTROS E VALIDAÇÕES
# ============================================

validacoes:
  # Status de contrato considerados "ativos"
  status_contrato_ativo:
    - "A"  # Ativo
    - "N"  # Normal
    # - "S"  # Suspenso (descomentar se aplicável)

  # Status de parcela considerados "a receber"
  status_parcela_a_receber:
    - "A"  # Aberto
    - "P"  # Parcial

  # Status de parcela considerados "pago"
  status_parcela_pago:
    - "Q"  # Quitado
    - "L"  # Liquidado

# ============================================
# LOGS E MONITORAMENTO
# ============================================

logging:
  # Nível de log (DEBUG, INFO, WARNING, ERROR, CRITICAL)
  level: "INFO"

  # Registrar chamadas à API (pode gerar muito log)
  log_api_calls: true

  # Registrar dados transformados (útil para debug)
  log_transformed_data: false

  # Caminho para arquivo de log de auditoria
  audit_log_path: "logs/mega_sync_audit.log"
